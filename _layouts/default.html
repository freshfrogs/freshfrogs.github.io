<!DOCTYPE html>
<style>
img { 
  width: 32%;
  image-rendering: pixelated;
  border-radius: 1%;
  padding: 1px;
  transition: transform .2s;
}
.collectionImg { 
  width: 10px;
  border-radius: 10%;
}
.collection {
  transition: transform .2s;
  image-rendering: pixelated;
  margin-left: auto;
  margin-right: auto;
  border-radius: 1%;
  display: flex;
  flex-wrap: wrap;
  width: 32px;
}
img:hover{
  -ms-transform: scale(1.5); /* IE 9 */
  -webkit-transform: scale(1.5); /* Safari 3-8 */
  transform: scale(1.5); 
}
.pixelated2 { 
    width: 80px;
    image-rendering: pixelated;
    margin: 0px;
    filter: blur(0px);
    padding: 0px;
}
header {
  text-rendering: pixelated;
}
.pointer{
  cursor: pointer;
}
.pointerOff{
  cursor: wait;
}
.noPointer{
  cursor: default;
}
.test {
  filter: blur(0px);
  border-radius: 1%;
}
.help{
  cursor: help;
}
.page-body {
  background-image: url("/assets/background.png");
  image-rendering: pixelated;
  }
.page-section {
  font-family: monospace;
  font-weight: 550;
  color: rgba(126, 183, 128, 1);;
  font-size: medium;
  image-rendering: pixelated;
  text-align: center;
  }
pre{
  font-size: small;
  border-radius: 1%;
}
.h1 {
  font-family: sans-serif;
  font-weight: 800;
  color: white;
  text-align: center;
  image-rendering: pixelated;
  padding: 0%;
  }
.h2 {
  font-family: sans-serif;
  font-weight: 800;
  color: white;
  text-align: center;
  image-rendering: auto;
  padding: 0%;
  height: 75px;
  line-height: 75px;
  vertical-align: middle;
  }
.h3 {
  font-family: sans-serif;
  font-weight: 800;
  padding: 0%;
  color: white;
  text-align: center;
  image-rendering: pixelated;
  }
.pixelated {
  transition: transform .2s;
  image-rendering: pixelated;
  width: auto;
  margin-left: auto;
  margin-right: auto;
  display: block;
  border-radius: 1%;
}
.pixelated:hover{
  -ms-transform: scale(1.1); /* IE 9 */
  -webkit-transform: scale(1.1); /* Safari 3-8 */
  transform: scale(1.1); 
}
.downloads:hover{
  -ms-transform: scale(1.1); /* IE 9 */
  -webkit-transform: scale(1.1); /* Safari 3-8 */
  transform: scale(1.1); 
}
.foot{
  position: absolute;
  top: 60%;
  width: 50%;
  padding: 0px;
  image-rendering: pixelated;
  display: flex;
  flex-wrap: wrap;
  border-radius: 1%;
  margin-left: auto;
  margin-right: auto;
}
.os{
  float: left;
  width: 25%;
  image-rendering: auto;
}
.foot2{
  image-rendering: pixelated;
  display: flex;
  flex-wrap: wrap;
}
</style>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.0-rc.0/web3.min.js"></script>
    <script src="https://unpkg.com/f0js/dist/f0.js"></script>
    <script>
      const f0 = new F0();
      const web3 = new Web3(window.ethereum)
      document.addEventListener("DOMContentLoaded", async () => { // https://nf7uos.github.io/
        for(let frog=1; frog<=44; frog++) {
          let frogSource = "https://gateway.pinata.cloud/ipfs/QmcdUZdPeUieekmTgZv7rHnuZhojRktAKN3tDn2pZSHMvF/"+frog+".png";
          let frogCreate = document.createElement("img")
          frogCreate.src = frogSource
          frogCreate.className = "collection"
          document.getElementById("collection").appendChild(frogCreate)
        }
        document.querySelector("pre").innerHTML = "Please connect an Ethereum wallet... <b><a href='https://nf7uos.github.io/'>Connect</a></b>"+"\nDon't have a wallet?... <b><a href='https://metamask.io/download/'>Download MetaMask</a></b>"
       // document.querySelector("pre").innerHTML = ""
        let net = await web3.eth.getChainId()
        console.log("net = ", net)
        await window.ethereum.send('eth_requestAccounts');
        try {
          document.querySelector("pre").innerHTML = "Please connect an Ethereum wallet... <b>Connecting...</b>"+"\nDon't have a wallet?... <b><a href='https://metamask.io/download/'>Download MetaMask</a></b>"
          await f0.init({
            web3: web3,
            contract: "0x9500aEe4F34681D38D2f53C634b36b9CCc236d10",
            network: "rinkeby"
          })
          let nextId = await f0.api.nextId().call()
          let random = Math.floor((Math.random() * 40) + 1);
          let token = await f0.get(nextId);
          var userAcc = web3.currentProvider.selectedAddress;
          let estimate = await f0.mintCost(null, 1); //f0.myInvites()
          var remaining = 4040 - nextId;
          console.log(estimate);
        //  var last5 = userAcc.substring(0, 5); //0xF01e067d442f4254cd7c89A5D42d90ad554616E8 42
        //  var first5 = userAcc.substring(0, -5);
          var userAcc = userAcc.substring(0, 5)+"..."+userAcc.slice(-4);
          console.log(token)
          document.getElementById("nextMint").setAttribute("src", token.converted.image)
          document.querySelector("img").setAttribute("alt", "logo")
          for(let i=1; i<=9; i++) {
            let token2 = await f0.get(nextId-i);
            let el = document.createElement("img")
            el.src = token2.converted.image
            document.getElementById("foot2").appendChild(el)
          }
          //
          document.getElementById("ul2").innerHTML = "<ul class='downloads'>"+"<li><a class='pointer'><strong>"+remaining+"</strong>remaining</a></li>\n<li><a class='noPointer'><strong>Recently Minted</strong></a></li>\n<li><a class='pointer'><strong>View</strong>see collection</a></li></ul>"
          //
          document.querySelector("id").innerHTML = "<strong>FROG #"+nextId+"</strong>available mint" //<strong>4,040</strong>frogs
          document.querySelector("idMint").innerHTML = "<strong>MINT</strong>(transact)" //<strong>MINT</strong>(link wallet)
          document.querySelector("#mint").removeAttribute("href")
          document.querySelector("pre").innerHTML = "Please connect an Ethereum wallet... <b><i>"+userAcc+" ✓</i></b>\n<b><strong>FROG #"+nextId+"</strong></b> is now available for mint... <a href=''><b>See Invites</b></a>"
          document.querySelector("#gasEst").addEventListener("click", async (e) => {
            var x = document.querySelector("pre").innerHTML;
           // var gasEstRounded = Math.round(JSON.stringify(estimate.eth.safeLow, null, 1) * 100) / 100
            document.querySelector("pre").innerHTML = x+"\nEstimated gas fee... <b>< "+Math.round(JSON.stringify(estimate.eth.safeLow, null, 1) * 1000) / 1000+" ΞEth ($"+Math.round(JSON.stringify(estimate.usd.safeLow, null, 1) * 100) / 100+")</b>" //JSON.stringify(estimate[key].condition.converted.eth, null, 1)
          })
          //
          document.querySelector("#mint").addEventListener("click", async (e) => {
            var x = document.querySelector("pre").innerHTML;
            document.querySelector("pre").innerHTML = x+"\nMinting <b>FROG #"+nextId+"</b>... please sign the transaction..."
            // Mint 2 with public invite
            let tokens = await f0.mint(null, 1)
            var openseaTest = tokens.map((token) => {
              return token.links.opensea
            })
            var x = document.querySelector("pre").innerHTML;
            document.querySelector("pre").innerHTML = x+"<br><hr><h2 class='h2'>Congratulations!</h2>"+"<b>FROG #"+nextId+" </b>has successfully been minted! <a href='"+openseaTest+"'><b>View on Opensea</a></b><hr>"
          })
        } catch (e) { 
          var x = document.querySelector("pre").innerHTML;
          document.querySelector("pre").innerHTML = x+"\n<b>"+e.message+"! <a href='https://nf7uos.github.io/'>Refresh</a></b>" }
      })
    </script>
  </head>
  <body class="page-body">
    <div class="wrapper">
      <header>
        <img class="os pixelated pointer" src="openseaLogoW.png" href="https://testnets.opensea.io/collection/forestfrog2"><a href="https://testnets.opensea.io/collection/forestfrog2"><h2 class="h2">View Collection</h2></a>

        <img id="nextMint" class="test pixelated" src="/assets/preview.gif">
        <ul class="downloads">
          <li><a class="help"><id><strong>4,040</strong>frogs</id></a></li>
          <li><a id="gasEst" class="help" id="gas"><strong>0.04 ΞEth</strong>plus gas</a></li>
          <li><a id="mint" class="pointer" href="https://nf7uos.github.io/"><idMint><strike><strong>Mint</strong></strike>connect wallet!</idMint></a></li>
        </ul>
        <foot class="foot2" id="foot2"></foot>
        <div id="ul2"></div>
      </header>
      <section class="page-section">
        {{ content }}
        <hr>
      </section>
      <footer>
      </footer>
    </div>
    <script src="{{ "/assets/js/scale.fix.js" | relative_url }}"></script>
  </body>
  <body class="collection page-body" id="collection"></body>
</html>
