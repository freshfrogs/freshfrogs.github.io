<!DOCTYPE html>
<style>
img { 
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 5px;
    width: 128px;
}
.page-body{
  background-image: url("/assets/background.png");
  image-rendering: pixelated;
  }
.page-section{
  font-family: monospace;
  font-weight: 550;
  color: rgba(126, 183, 128, 1);;
  font-size: small;
  }
.h1{
  font-family: sans-serif;
  font-weight: 800;
  color: white;
  }
.pixelated {
  image-rendering: pixelated;
  width: auto;
}
</style>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.0-rc.0/web3.min.js"></script>
    <script src="https://unpkg.com/f0js/dist/f0.js"></script>
    <script>
      const f0 = new F0();
      const web3 = new Web3(window.ethereum)

      document.addEventListener("DOMContentLoaded", async () => { // https://nf7uos.github.io/
        document.querySelector("pre").innerHTML = "Please connect your Ethereum wallet. <b><a href='https://nf7uos.github.io/'>Connect</a></b>\nDon't have a wallet? <b><a href='https://metamask.io/download/'>Download MetaMask</a></b>"
        let net = await web3.eth.getChainId()
        console.log("net = ", net)
        await window.ethereum.send('eth_requestAccounts');
        try {
          document.querySelector("pre").innerHTML = "Connecting to Ethereum blockchain..."
          await f0.init({
            web3: web3,
            contract: "0x9500aEe4F34681D38D2f53C634b36b9CCc236d10",
            network: "rinkeby"
          })
          let nextId = await f0.api.nextId().call()
          let random = Math.floor((Math.random() * 40) + 1);
          let token = await f0.get(nextId);
          var userAcc = web3.currentProvider.selectedAddress;
        //  var last5 = userAcc.substring(0, 5); //0xF01e067d442f4254cd7c89A5D42d90ad554616E8 42
        //  var first5 = userAcc.substring(0, -5);
          var userAcc = userAcc.substring(0, 5)+"..."+userAcc.slice(-4);
          console.log(token)
         // document.querySelector("img").setAttribute("src", token.converted.image)
         // document.querySelector("img").setAttribute("alt", "logo")
          for(let i=1; i<=42; i++) {
            let token = await f0.get(i);
            let el = document.createElement("img")
            el.src = token.converted.image
            document.getElementById("test").appendChild(el)
          }
          document.querySelector("id").innerHTML = "# "+nextId
        //  document.querySelector("id2").innerHTML = "\n["+userAcc+"]\n"
          var x = document.querySelector("pre").innerHTML;
          document.querySelector("pre").innerHTML = x+" <b> Connected </b>\nYou can now mint to your account. <b> "+userAcc+" </b>"//Invite codes automatically applied."
          document.querySelector("#mint").addEventListener("click", async (e) => {
            var x = document.querySelector("pre").innerHTML;
            document.querySelector("pre").innerHTML = x+"\n<b>Minting... please sign the transaction and wait.</b>"
            // Mint 2 with public invite
            let tokens = await f0.mint(null, 1)
            document.querySelector("pre").innerHTML = JSON.stringify(tokens, null, 1)
          })
        } catch (e) { 
          var x = document.querySelector("pre").innerHTML;
          document.querySelector("pre").innerHTML = x+"\n<b>"+e.message+"! <b><a href='https://nf7uos.github.io/'>Refresh</a></b> the page...</b>" }
      })
    </script>
  </head>
  <body class="page-body">
    <div class="wrapper">
      <header>

        <img class="pixelated" src="/assets/FR0G.png">

        <ul class="downloads">
          <li><a><strong><id>4,040</id></strong>frog</a></li>
          <li><a><strong>0.04 ETH</strong>plus gas</a></li>
          <li><a id="mint"><strong>MINT</strong>(click here)</a></li>
        </ul>
        <p></p>
      </header>
      <section class="page-section">
        <h1 class="h1">Fresh Frogs NFT Collection</h1>
        {{ content }}
        <section id="test"></section>
      </section>
      <footer>
        {% include head-custom.html %}
      </footer>
    </div>
    <script src="{{ "/assets/js/scale.fix.js" | relative_url }}"></script>
  </body>
</html>
