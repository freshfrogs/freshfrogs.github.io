<!DOCTYPE html>
<style>
img { 
    width: 128px;
    image-rendering: pixelated;
    margin: 2px;
    filter: blur(0px);
}
.pixelated2 { 
    width: 80px;
    image-rendering: pixelated;
    margin: 0px;
    filter: blur(0px);
    padding: 0px;
}
header {
  text-rendering: pixelated;
}
.pointer{
  cursor: pointer;
}
.pointerOff{
  cursor: wait;
}
.test{
  filter: blur(0px);
}
.help{
  cursor: help;
}
.page-body {
  background-image: url("/assets/background.png");
  image-rendering: pixelated;
  }
.page-section {
  font-family: monospace;
  font-weight: 550;
  color: rgba(126, 183, 128, 1);;
  font-size: small;
  image-rendering: pixelated;
  text-align: center;
  }
.h1 {
  font-family: sans-serif;
  font-weight: 800;
  color: white;
  text-align: center;
  image-rendering: pixelated;
  }
.h2 {
  font-family: sans-serif;
  font-weight: 800;
  text-align: center;
  image-rendering: pixelated;
  }
.h3 {
  font-family: sans-serif;
  font-weight: 800;
  color: white;
  text-align: center;
  image-rendering: pixelated;
  }
.pixelated {
  image-rendering: pixelated;
  width: auto;
  margin-left: auto;
  margin-right: auto;
  display: block;
}
.foot{
  position: absolute;
  top: 60%;
  width: 50%;
  padding: 15px 0;
  margin-left: 25%;
  margin-right: 25%;
  image-rendering: pixelated;
  display: flex;
  flex-wrap: wrap;
  background-color: blur(4px);
}
</style>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.0-rc.0/web3.min.js"></script>
    <script src="https://unpkg.com/f0js/dist/f0.js"></script>
    <script>
      const f0 = new F0();
      const web3 = new Web3(window.ethereum)
      document.addEventListener("DOMContentLoaded", async () => { // https://nf7uos.github.io/
        document.querySelector("pre").innerHTML = "Please connect an Ethereum wallet... <b><a href='https://nf7uos.github.io/'>Connect</a></b>"+"\nDon't have a wallet?... <b><a href='https://metamask.io/download/'>Download MetaMask</a></b>"
       // document.querySelector("pre").innerHTML = ""
        let net = await web3.eth.getChainId()
        console.log("net = ", net)
        await window.ethereum.send('eth_requestAccounts');
        try {
          document.querySelector("pre").innerHTML = "Please connect an Ethereum wallet... <b>Connecting...</b>"+"\nDon't have a wallet?... <b><a href='https://metamask.io/download/'>Download MetaMask</a></b>"
          await f0.init({
            web3: web3,
            contract: "0x9500aEe4F34681D38D2f53C634b36b9CCc236d10",
            network: "rinkeby"
          })
          let nextId = await f0.api.nextId().call()
          let random = Math.floor((Math.random() * 40) + 1);
          let token = await f0.get(nextId);
          var userAcc = web3.currentProvider.selectedAddress;
          let estimate = await f0.mintCost(null, 1); //f0.myInvites()
          console.log(estimate);
        //  var last5 = userAcc.substring(0, 5); //0xF01e067d442f4254cd7c89A5D42d90ad554616E8 42
        //  var first5 = userAcc.substring(0, -5);
          var userAcc = userAcc.substring(0, 5)+"..."+userAcc.slice(-4);
          console.log(token)
          document.getElementById("test").setAttribute("src", token.converted.image)
          document.getElementById("test").setAttribute("class", "test pixelated")
          document.querySelector("img").setAttribute("alt", "logo")
//          for(let i=1; i<=28; i++) {
//            let i2 = nextId+i
//            let token2 = await f0.get(i2);
//            let el = document.createElement("img")
//            el.src = token2.converted.image
//            document.getElementById("foot").appendChild(el)
//          }
          document.querySelector("id").innerHTML = "<strong>FROG #"+nextId+"</strong>available mint" //<strong>4,040</strong>frogs
          document.querySelector("idMint").innerHTML = "<strong>MINT</strong>(transact)" //<strong>MINT</strong>(link wallet)
          document.querySelector("idMint").setAttribute("href","")
          document.querySelector("pre").innerHTML = "Please connect an Ethereum wallet... <b><i>"+userAcc+" ✓</i></b>\n<b><strong>FROG #"+nextId+"</strong></b> is now available for mint... <a href=''><b>See Invites</b></a>"
          document.querySelector("#gasEst").addEventListener("click", async (e) => {
            var x = document.querySelector("pre").innerHTML;
           // var gasEstRounded = Math.round(JSON.stringify(estimate.eth.safeLow, null, 1) * 100) / 100
            document.querySelector("pre").innerHTML = x+"\nEstimated gas fee... <b>ΞEth "+Math.round(JSON.stringify(estimate.eth.safeLow, null, 1) * 10000) / 10000+"($USD "+JSON.stringify(estimate.usd.safeLow, null, 1) * 10000) / 10000+")</b>" //JSON.stringify(estimate[key].condition.converted.eth, null, 1)
          })
          //
          document.querySelector("#mint").addEventListener("click", async (e) => {
            var x = document.querySelector("pre").innerHTML;
            document.querySelector("pre").innerHTML = x+"\nMinting <b>FROG #"+nextId+"</b>... please sign the transaction..."
            // Mint 2 with public invite
            let tokens = await f0.mint(null, 1)
            var x = document.querySelector("pre").innerHTML;
            document.querySelector("pre").innerHTML = x+JSON.stringify(tokens, null, 1)+"<b><a href=''>FROG #"+nextId+" has been successfully minted!</a></b>"
          })
        } catch (e) { 
          var x = document.querySelector("pre").innerHTML;
          document.querySelector("pre").innerHTML = x+"\n<b>"+e.message+"! <a href='https://nf7uos.github.io/'>Refresh</a></b>" }
      })
    </script>
  </head>
  <body class="page-body">
    <div class="wrapper">
      <header>
        </br>

        <img id="test" class="pixelated" src="/assets/preview.gif">

        <ul class="downloads">
          <li><a class="help"><id><strong>4,040</strong>frogs</id></a></li>
          <li><a id="gasEst" class="help" id="gas"><strong>0.04 ΞEth</strong>plus gas</a></li>
          <li><a id="mint" class="pointer" href="https://nf7uos.github.io/"><idMint><strong>Connect</strong>(link wallet)</idMint></a></li>
        </ul>
        <section class="page-section"></section>
        <section id=""></section>
      </header>
      <section class="page-section">
        {{ content }}
      </section>
      <footer> 
      </footer>
    </div>
    <script src="{{ "/assets/js/scale.fix.js" | relative_url }}"></script>
    <foot class="foot" id="foot"></foot>
  </body>
</html>
