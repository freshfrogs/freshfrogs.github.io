<!DOCTYPE html>
<style>
  .pointer {
      cursor: pointer;
  }
  .pointerOff {
      cursor: pointer;
  }
  .process {
    cursor: pointer;
  }
  .processImages{
    cursor: pointer;
  }
  .collection{
    cursor: pointer;
  }
  .collectionImg{
    cursor: pointer;
  }
  .nextTokenImg{
    width: auto;
  }
  .page-body {
    background-image: url("/assets/background.png");
    image-rendering: pixelated;
  }
  .page-section {
    font-family: monospace;
    font-weight: 550;
    color: rgba(126, 183, 128, 1);;
    font-size: medium;
    image-rendering: pixelated;
    text-align: center;
  }
  .pre {
    font-size: small;
    border-radius: 1%;
    text-align: center;
    image-rendering: pixelated;
  }
  .h1 {
    font-family: sans-serif;
    font-weight: 800;
    color: white;
    text-align: center;
    image-rendering: pixelated;
    padding: 0%;
  }
  .h2 {
    font-family: sans-serif;
    font-weight: 800;
    color: white;
    text-align: center;
    image-rendering: pixelated;
    font-size: large;
    padding: 0%;
    height: 300%;
    line-height: 300%;
    vertical-align: middle;
  }
  .h3 {
    font-weight: 800;
    text-align: center;
    image-rendering: pixelated;
    padding: 0%;
    font-size: large;
  }
  .os{
    float: left;
    width: 20%;
    image-rendering: pixelated;
    vertical-align: middle;
    padding: 0px;
    margin: -5px;
    border-radius: 100%;
  }
  .collectionImg { 
    transition: transform .2s;
    width: 96px;
    vertical-align: center;
    margin-top: 0px;
    margin-left: 8px;
    margin-right: 8px;
    margin-bottom: 0px;
    border-radius: 1%;
    text-align: center;
    box-shadow: 5px 10px rgba(211, 211, 211, 0.329);
  }
  .collection {
    image-rendering: pixelated;
  }
  .collectionImg:hover{
    -ms-transform: scale(2.0); /* IE 9 */
    -webkit-transform: scale(2.0); /* Safari 3-8 */
    transform: scale(2.0);
    box-shadow: none;
  }
  .pixelated{
    image-rendering: pixelated;
  }
  .nextTokenImgCont{
    width: 100%;
  }
  .nextTokenImgCont2{
    width: calc(100% / 2);
  }
  .nextTokenImgCont3{
    width: calc(100% / 3);
  }
  .nextTokenImg{
    display: inline-flex;
    image-rendering: pixelated;
  }
</style>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->

    <!-- ----------------------------------- Begin Script f0 / Call all web3 variables ------------------------------------ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.0-rc.0/web3.min.js"></script>
    <script src="https://unpkg.com/f0js/dist/f0.js"></script>
    <script> // Script begins -- call variables and link web3
      const f0 = new F0();
      const web3 = new Web3(window.ethereum)
      document.addEventListener("DOMContentLoaded", async () => {
        //
        // Load images inside <pre>
        // Load images inside <pre>
        for(let frog=1; frog<=3; frog++) {
          let whichFrog = Math.floor(Math.random() * 4035)+frog;
          let frogSource = "https://gateway.pinata.cloud/ipfs/QmcdUZdPeUieekmTgZv7rHnuZhojRktAKN3tDn2pZSHMvF/"+whichFrog+".png";
          document.getElementById("frog"+frog).innerHTML = "<img src='"+frogSource+"' id='frogImg"+frog+"' class='collectionImg' alt='"+whichFrog+"'></a>"
        }
        //
        //
        //
        try {
          await f0.init({
            web3: web3,
            contract: "0x9500aEe4F34681D38D2f53C634b36b9CCc236d10",
            network: "rinkeby"
          })
          // connecting message
          document.getElementById("netStatus").innerHTML = "Please connect an Ethereum wallet... <b><i>connecting...</i></b>"

          var userAcc = web3.currentProvider.selectedAddress;
          var userAcc = userAcc.substring(0, 5)+"..."+userAcc.slice(-4);
          var mintCount = 1;
          let nextId = await f0.api.nextId().call()
          let token = await f0.get(nextId);
          
          let estimate = await f0.mintCost(null, 1);
          var remaining = 4040 - nextId;
          console.log(estimate);
          console.log(token)
          //
          // Next frogs generated
          //
          for(let i=0; i<=2; i++) {
            let nextTokenInit = parseInt(nextId) + i;
            let nextToken = await f0.get(nextTokenInit);
            document.getElementById("frogImg"+(i+1)).setAttribute("src", nextToken.converted.image)
            document.getElementById("frogImg"+(i+1)).setAttribute("alt", nextTokenInit)
          }
          //

          // Update website layout with set variables
          document.getElementById("nextTokenImg").setAttribute("src", token.converted.image) // Set preview image to next token ID
          document.getElementById("nextToken").innerHTML = "<strong>FROG #"+nextId+"</strong>available mint" // Update next token ID
          document.getElementById("mintTransact").innerHTML = "<strong>MINT</strong>(transact)" // Update Mint button
          document.getElementById("mintTransact").removeAttribute("href") // Removes mint button link
          document.getElementById("netStatus").innerHTML = "Please connect an Ethereum wallet... <b><i>"+userAcc+" ✓</i></b>"
          document.getElementById("pre").innerHTML = document.getElementById("pre").innerHTML+"\n<b><strong>FROG #"+nextId+"</strong></b> is now available for mint... <a href=''><b>See Invites</b></a>"

          // FIRST FROG
          document.querySelector("#frog1").addEventListener("click", async (e) => {
            //
            let tokenOneThis = document.getElementById("frogImg1").getAttribute('alt')
            let tokenOne = await f0.get(tokenOneThis);
            document.getElementById("nextTokenImg").setAttribute("src", tokenOne.converted.image);
            document.getElementById("nextTokenImg").setAttribute("alt", tokenOneThis);
            //
            document.getElementById("nextTokenImgCont").setAttribute("class", "nextTokenImgCont")
            //
            document.getElementById("nextTokenImg2").removeAttribute("src");
            document.getElementById("nextTokenImg2").removeAttribute("alt");
            document.getElementById("nextTokenImg3").removeAttribute("src");
            document.getElementById("nextTokenImg3").removeAttribute("alt");
            //
            var mintCount = 1;
          })
          // SECOND FROG
          document.querySelector("#frog2").addEventListener("click", async (e) => {
            //
            let tokenOneThis = document.getElementById("frogImg1").getAttribute('alt')
            let tokenOne = await f0.get(tokenOneThis);
            document.getElementById("nextTokenImg").setAttribute("src", tokenOne.converted.image);
            document.getElementById("nextTokenImg").setAttribute("alt", tokenOneThis);
            //
            let tokenTwoThis = document.getElementById("frogImg2").getAttribute('alt')
            let tokenTwo = await f0.get(tokenTwoThis);
            document.getElementById("nextTokenImg2").setAttribute("src", tokenTwo.converted.image);
            document.getElementById("nextTokenImg2").setAttribute("alt", tokenTwoThis);
            //
            document.getElementById("nextTokenImg3").removeAttribute("src");
            document.getElementById("nextTokenImg3").removeAttribute("alt");
            //
            document.getElementById("nextTokenImgCont").setAttribute("class", "nextTokenImgCont2")
            var mintCount = 2;
          })
          // THIRD FROG
          document.querySelector("#frog3").addEventListener("click", async (e) => {
            let tokenOneThis = document.getElementById("frogImg1").getAttribute('alt')
            let tokenOne = await f0.get(tokenOneThis);
            document.getElementById("nextTokenImg").setAttribute("src", tokenOne.converted.image);
            document.getElementById("nextTokenImg").setAttribute("alt", tokenOneThis);
            //
            let tokenTwoThis = document.getElementById("frogImg2").getAttribute('alt')
            let tokenTwo = await f0.get(tokenTwoThis);
            document.getElementById("nextTokenImg2").setAttribute("src", tokenTwo.converted.image);
            document.getElementById("nextTokenImg2").setAttribute("alt", tokenTwoThis);
            //
            let tokenThreeThis = document.getElementById("frogImg3").getAttribute('alt')
            let tokenThree = await f0.get(tokenThreeThis);
            document.getElementById("nextTokenImg3").setAttribute("src", tokenThree.converted.image);
            document.getElementById("nextTokenImg3").setAttribute("alt", tokenThreeThis);
            //
            document.getElementById("nextTokenImgCont").setAttribute("class", "nextTokenImgCont3")
            var mintCount = 3;
          })
          // Event listeners
          document.querySelector("#gasEst").addEventListener("click", async (e) => { // Gas estimate button
            document.querySelector("pre").innerHTML = document.querySelector("pre").innerHTML+"\nEstimated gas fees... <b>< "+Math.round(JSON.stringify(estimate.eth.safeLow, null, 1) * 1000) / 1000+" ΞEth ($"+Math.round(JSON.stringify(estimate.usd.safeLow, null, 1) * 100) / 100+")</b>"
          })
          document.querySelector("#mintTransact").addEventListener("click", async (e) => { // Mint button
            document.getElementById("pre").innerHTML = document.getElementById("pre").innerHTML+"\nMinting <b>FROG #"+nextId+"</b>... please sign the transaction and wait..."
            // Runs mint function through web3/f0
            let tokens = await f0.mint(null, mintCount)
            var openseaTest = tokens.map((token) => { // return opensea link for newly minted token
              return token.links.opensea
            })
            document.getElementById("pre").innerHTML = document.getElementById("pre").innerHTML+"<hr><h3 class='h3'>Congratulations!</h3>"+"<b>FROG #"+nextId+" </b>has successfully been minted! <a href='"+openseaTest+"'><b>View on Opensea</a></b><hr>"
          })
        } catch (e) { // Catch and return errors
          document.querySelector("pre").innerHTML = document.getElementById("pre").innerHTML+"\n<b>"+e.message+"! <a href='https://nf7uos.github.io/'>Refresh</a></b>" }
      })
    </script>
  </head>
  <body class="page-body"> <!-- Main Body -->
    <div class="wrapper">
      <header class="pixelated"> <!-- Left Side Header / Opensea Link / Preview Image -->
        <img class="os pixelated pointer" src="opensea.jpg" href="https://testnets.opensea.io/collection/forestfrog2"><a href="https://testnets.opensea.io/collection/forestfrog2"><h2 class="h2">View Collection</h2></a>
        <div class="nextTokenImgCont" id="nextTokenImgCont"><img id="nextTokenImg" class="nextTokenImg" src="/assets/preview.gif"><img id="nextTokenImg2" class="nextTokenImg" src=""><img id="nextTokenImg3" class="nextTokenImg" src=""></div>
        <ul class="downloads">
            <li>
                <a id="nextToken" class="pointerOff"><strong>4,040</strong>frogs</a>
            </li>
            <li>
                <a id="gasEst" class="pointerOff"><strong>0.04 ΞEth</strong>plus gas</a>
            </li>
            <li>
                <a id="mintTransact" class="pointer" href="https://nf7uos.github.io/"><b><strike><strong>Mint</strong></strike></b>link wallet!</a>
            </li>
        </ul>
      </header>
      <section class="page-section"> <!-- Main Content Layout / Index.md -->
        {{ content }}
        <pre id="pre" class="pre"><br><h2 class="h3">How to Mint</h2><div class= "collection" id="collection"><a id="frog1"></a><a id="frog2"></a><a id="frog3"></a></div><br><hr><netStatus id="netStatus">Please connect an Ethereum wallet... <b><a href='https://nf7uos.github.io/'>Connect</a></b><br>Don't have a wallet?... <b><a href='https://metamask.io/download/'>Download MetaMask</a></b> <br><hr></netStatus></pre>
      </section>
      <footer> <!-- Footer? -->
      </footer>
    </div>
    <script src="{{ "/assets/js/scale.fix.js" | relative_url }}"></script>
  </body>
</html>
